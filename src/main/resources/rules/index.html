<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>

    <!-- jquery-ui after bootstrap as a workaround for missing close icon.
    http://stackoverflow.com/questions/17367736/jquery-ui-dialog-missing-close-icon-->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!--Cytoscape-->
    <script src="lib/cytoscape.min-3.8.1.js"></script>
    <script src="lib/cytoscape-cose-bilkent-4.0.0.js"></script>

    <!--D3-->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>

    <!--Venn diagram-->
    <script src="lib/venn.min.js"></script>
    <!--Spinner-->
    <script src="lib/spin.js"></script>
    <!--NotifyJS-->
    <script src="lib/notify.min.js"></script>
    <!--Upset.js-->
    <script src="lib/upset.js"></script>
    <!--Heatmap.js-->
    <script src="lib/heatmap.js"></script>

    <script src="util.js"></script>
    <script src="fishbone.js"></script>
    <script src="graph.js"></script>
    <script>
        <!-- Init jQuery UI dialog-->
        $(function () {
            $("#dialog").dialog({autoOpen: false});
        });
        $(function () {
            $("#fpgrowth-alg-dialog").dialog({autoOpen: false});
        });
        $(function () {
            $("#decisiontree-alg-dialog").dialog({autoOpen: false});
        });
    </script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body onload="initialize(); runAnalysis({checked: true})">

<div id="dialog" title="Information">
    <div id="dialog-pane"></div>
</div>
<div id="fpgrowth-alg-dialog" title="Fp-growth algorithm results">
    <div id="fpgrowth-alg-dialog-pane"></div>
</div>
<div id="decisiontree-alg-dialog" title="Decision tree algorithm results">
    <div id="decisiontree-alg-dialog-pane"></div>
</div>
<nav id="navbar-top" class="navbar navbar-default">
    <div class="container-fluid">
        <form class="navbar-form navbar-left">
            <label>
                <input type="radio" name="action-type" onchange="runAnalysis(this)" checked="checked">
                Run analysis on data files
            </label>
            <label></label>
            <label></label>
            <label>
                <input type="radio" name="action-type" onchange="loadResultFile(this)">
                Load result files
            </label>

            <div id="run-analysis">
                <div>
                    <label id="predicates-file-label" for="predicates-file-button">Predicates</label>
                    <input id="predicates-file" type="file" style="display: none" multiple="multiple"/>
                    <input id="predicates-file-button" type="button" class="btn btn-primary" value="Load"
                           onclick="$('#predicates-file').click();"/>
                    <label id="bed-database-file-label" for="bed-database-file-button">Database</label>
                    <input id="bed-database-file" type="file" style="display: none" multiple="multiple"/>
                    <input id="bed-database-file-button" type="button" class="btn btn-primary" value="Load"
                           onclick="$('#bed-database-file').click();"/>
                    <label id="targets-file-label" for="targets-file-button">Targets</label>
                    <input id="targets-file" type="file" style="display: none" multiple="multiple"/>
                    <input id="targets-file-button" type="button" class="btn btn-primary" value="Load"
                           onclick="$('#targets-file').click();"/>
                    <label id="experiment-type-label" for="experiment-type">Experiment type:</label>
                    <select id="experiment-type" name="name" required>
                        <option value="GENOME" selected="selected">GENOME</option>
                        <option value="CHIANTI">CHIANTI</option>
                    </select>
                    <label id="genome-label" for="genome">Genome:</label>
                    <select id="genome" name="name">
                        <option value="mm10" selected="selected">mm10</option>
                        <option value="mm9">mm9</option>
                        <option value="hg38">hg38</option>
                        <option value="hg19">hg19</option>
                    </select>
                    <select id="info-criterion">
                        <option value="conviction">conviction</option>
                        <option value="loe">loe</option>
                    </select>
                    <input id="run-name" placeholder="run name"/>&nbsp;
                    <label id="port-label" for="port">Port:</label>
                    <input type="number" id="port" name="port" value="8080">
                    <input id="run-analysis-button" type="button" class="btn btn-primary" value="Run analysis"
                           onclick="runAnalysisOnLoadedData()"/>
                </div>

                <div style="padding-top: 5px">
                    <label id="topRules-label" for="topRules"># top rules:</label>
                    <input type="number" step="0.001" id="topRules" name="name" min="5" max="25" value="10">
                    <label id="exploratoryFraction-label" for="exploratoryFraction">Exploratory fraction:</label>
                    <input type="number" step="0.1" id="exploratoryFraction" name="name" min="0.1" max="1.0" value="0.5">
                    <label id="nSampling-label" for="nSampling"># sampling:</label>
                    <input type="number" step="10" id="nSampling" name="name" min="0" max="1000" value="150">
                    <label id="samplingType-label" for="samplingStrategy">Sampling type:</label>
                    <select id="samplingStrategy" name="name" required>
                        <option value="NONE" selected="selected">NONE</option>
                        <option value="UPSAMPLING">UPSAMPLING</option>
                        <option value="DOWNSAMPLING">DOWNSAMPLING</option>
                    </select>
                    <label id="significance-level-label" for="significance-level">Alpha (exploratory):</label>
                    <input type="number" step="0.001" id="significance-level" name="name" min="0.001" max="1" value="0.05">
                    <label id="alphaHoldout-label" for="alphaHoldout">Alpha (holdout):</label>
                    <input type="number" step="0.001" id="alphaHoldout" name="name" min="0.001" max="1" value="0.2">
                    <label id="alphaFull-label" for="alphaFull">Alpha (full):</label>
                    <input type="number" step="0.001" id="alphaFull" name="name" min="0.001" max="1" value="0.2">
                </div>
            </div>

            <div id="load-files" style="display: none">
                <label id="filename" style="display: inline">Fishbone</label>
                <input id="file" type="file" accept=".json" style="display: none"/>
                <input id="file-button" type="button" class="btn btn-primary" value="Load *.json" style="display: inline"
                       onclick="$('#file').click();"/>

                <label id="tree-filename" style="display: inline">Tree</label>
                <input id="tree-file" type="file" accept=".dot" style="display: none"/>
                <input id="tree-file-button" type="button" class="btn btn-primary" value="Load *.dot" style="display: inline"
                       onclick="$('#tree-file').click();"/>

                <label id="fpgrowth-filename" style="display: inline">FP-growth</label>
                <input id="fpgrowth-file" type="file" accept=".txt" style="display: none"/>
                <input id="fpgrowth-file-button" type="button" class="btn btn-primary" value="Load *.txt" style="display: inline"
                       onclick="$('#fpgrowth-file').click();"/>

                <input id="filename-to-download" class="form-control" placeholder="filename to dowload"/>
                <label id="experiment-type-label-download" for="experiment-type">Experiment type:</label>
                <select id="experiment-type-download" name="name" required>
                    <option value="GENOME" selected="selected">GENOME</option>
                    <option value="CHIANTI">CHIANTI</option>
                </select>
                <input id="download-file-button" type="button" class="btn btn-primary" value="Download" style="display: inline"
                       onclick="downloadFile();"/>
            </div>
            <script>
                function runAnalysis(x) {
                    if (x.checked) {
                        $("#run-analysis").show()
                        $("#load-files").hide()
                    }
                }

                function loadResultFile(x) {
                    if (x.checked) {
                        $("#run-analysis").hide()
                        $("#load-files").show()
                    }
                }
            </script>
        </form>
        <form class="navbar-form navbar-right">
            <label id="algorithms-label" for="algorithms">Run other algorithms</label>
            <div id="algorithms" class="checkbox navbar-btn">
                <!--<input type="checkbox" id="fishboneAlgCheckbox">
                <label for="fishboneAlgCheckbox">Fishbone</label>-->

                <input type="checkbox" id="ripperAlgCheckbox">
                <label for="ripperAlgCheckbox">Ripper</label>

                <input type="checkbox" id="fpGrowthAlgCheckbox">
                <label for="fpGrowthAlgCheckbox">FPGrowth</label>

                <input type="checkbox" id="decisionTreeAlgCheckbox">
                <label for="decisionTreeAlgCheckbox">Decision tree</label>
            </div>
        </form>
    </div>
</nav>
<nav id="navbar" class="navbar navbar-default">
    <form class="navbar-form navbar-left">
        <label id="display-title">Display settings:</label>

        <!-- Gap -->
        <label></label>
        <label></label>

        <label for="visualize-method">Type</label>
        <select disabled id="visualize-method">
            <option value="Fishbone">Fishbone</option>
            <option value="Graph">Graph</option>
        </select>&nbsp;&nbsp;&nbsp;

        <label for="target-filter">Target</label>
        <input disabled id="target-filter" class="form-control" placeholder="filter"/>&nbsp;

        <input disabled id="correlation-filter-min" class="form-control" type="number" min="0" max="1" step="0.1"
               value="0"/>
        <label for="correlation-filter-min">≤ Correlation ≤</label>
        <input disabled id="correlation-filter-max" class="form-control" type="number" min="0" max="1" step="0.1"
               value="1"/>&nbsp;

        <label for="support-filter">Support ≥</label>
        <input disabled id="support-filter" class="form-control" type="number" min="0" max="1" step="0.1" value="0"/>&nbsp;

        <label for="confidence-filter">Confidence ≥</label>
        <input disabled id="confidence-filter" class="form-control" type="number" min="0" max="1" step="0.1" value="0"/>&nbsp;

        <label for="conviction-filter">Conviction ≥</label>
        <input disabled id="conviction-filter" class="form-control" type="number" min="0" step="0.5" value="1"/>&nbsp;

        <label for="complexity-filter">Complexity ≤</label>
        <input disabled id="complexity-filter" class="form-control" type="number" min="0" step="1" value="1"/>&nbsp;

        <label for="show-top-filter">Show</label>
        <input disabled id="show-top-filter" class="form-control" type="number" min="1" step="1" value="5"/>&nbsp;

    </form>
    <form class="navbar-form navbar-right">
        <label for="alternative-results">Show other results</label>
        <div id="alternative-results" class="checkbox navbar-btn">
            <input type="button" id="fishboneSwitch" onclick="switchFishboneResults()" value="Switch to Ripper">

            <input type="checkbox" id="fpGrowthCheckbox" onclick="showFPGrowthResults()">
            <label for="fpGrowthCheckbox">FPGrowth</label>

            <input type="checkbox" id="decisionTreeCheckbox" onclick="showDecisionTreeResults()">
            <label for="decisionTreeCheckbox">Decision tree</label>
        </div>
    </form>
</nav>
<div id="main-panel">
    <div id="cy">
        <div id="about">
            <h1>Fishbone</h1>
            <pre>
        |\    \ \ \ \ \ \ \      __           ___
        |  \    \ \ \ \ \ \ \   | O~-_    _-~~   ~~-_
        |   >----|-|-|-|-|-|-|--|  __/   /  BELIEVE  )
        |  /    / / / / / / /   |__\   <              )
        |/     / / / / / / /             \_   ME !  _)
                                           ~--___--~
            </pre>
            <p>
                Developed by <a
                    href="https://research.jetbrains.org/groups/biolabs/projects?project_id=25">JetBrains Research</a>.
            </p>
        </div>
    </div>
</div>
</body>
</html>